<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‡å¹´å† - GitHub ä¸»é¡µ</title>
    <link rel="stylesheet" href="style.css">
    <!-- å¼•å…¥å†œå†åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.11/lunar.min.js"></script>
</head>
<body>
    <div class="calendar-container">
        <!-- å¤´éƒ¨æ§åˆ¶åŒºåŸŸ -->
        <header class="calendar-header">
            <button id="prevMonth" class="nav-btn">â€¹</button>
            <div class="date-info">
                <select id="yearSelect"></select>
                <span>å¹´</span>
                <select id="monthSelect">
                    <option value="0">1æœˆ</option>
                    <option value="1">2æœˆ</option>
                    <option value="2">3æœˆ</option>
                    <option value="3">4æœˆ</option>
                    <option value="4">5æœˆ</option>
                    <option value="5">6æœˆ</option>
                    <option value="6">7æœˆ</option>
                    <option value="7">8æœˆ</option>
                    <option value="8">9æœˆ</option>
                    <option value="9">10æœˆ</option>
                    <option value="10">11æœˆ</option>
                    <option value="11">12æœˆ</option>
                </select>
                <button id="todayBtn" class="today-btn">ä»Šå¤©</button>
            </div>
            <button id="nextMonth" class="nav-btn">â€º</button>
        </header>

        <!-- æ˜ŸæœŸæ ‡é¢˜ -->
        <div class="weekdays">
            <div class="weekday">æ—¥</div>
            <div class="weekday">ä¸€</div>
            <div class="weekday">äºŒ</div>
            <div class="weekday">ä¸‰</div>
            <div class="weekday">å››</div>
            <div class="weekday">äº”</div>
            <div class="weekday">å…­</div>
        </div>

        <!-- æ—¥æœŸç½‘æ ¼ -->
        <div id="calendarGrid" class="calendar-grid"></div>

        <!-- åº•éƒ¨ä¿¡æ¯ -->
        <footer class="calendar-footer">
            <div id="todayInfo" class="today-info"></div>
            <div class="github-link">
                <a href="https://github.com/ä½ çš„ç”¨æˆ·å/ä½ çš„ä»“åº“å" target="_blank">
                    ğŸ“¦ æŸ¥çœ‹æºç 
                </a>
            </div>
        </footer>
    </div>

    <script>
        class Calendar {
            constructor() {
                this.currentDate = new Date();
                this.today = new Date();
                this.init();
            }

            init() {
                this.bindEvents();
                this.generateYearOptions();
                this.render();
                this.updateTodayInfo();
            }

            bindEvents() {
                // æœˆä»½åˆ‡æ¢
                document.getElementById('prevMonth').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                    this.render();
                });

                document.getElementById('nextMonth').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                    this.render();
                });

                // å¹´ä»½é€‰æ‹©
                document.getElementById('yearSelect').addEventListener('change', (e) => {
                    this.currentDate.setFullYear(parseInt(e.target.value));
                    this.render();
                });

                // æœˆä»½é€‰æ‹©
                document.getElementById('monthSelect').addEventListener('change', (e) => {
                    this.currentDate.setMonth(parseInt(e.target.value));
                    this.render();
                });

                // ä»Šå¤©æŒ‰é’®
                document.getElementById('todayBtn').addEventListener('click', () => {
                    this.currentDate = new Date(this.today);
                    this.render();
                });
            }

            generateYearOptions() {
                const yearSelect = document.getElementById('yearSelect');
                const currentYear = this.today.getFullYear();
                
                // ç”Ÿæˆå¹´ä»½é€‰é¡¹ï¼ˆ1900-2100ï¼‰
                for (let year = 1900; year <= 2100; year++) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    if (year === currentYear) {
                        option.selected = true;
                    }
                    yearSelect.appendChild(option);
                }
            }

            render() {
                this.updateControls();
                this.generateCalendar();
            }

            updateControls() {
                // æ›´æ–°å¹´ä»½é€‰æ‹©å™¨
                document.getElementById('yearSelect').value = this.currentDate.getFullYear();
                // æ›´æ–°æœˆä»½é€‰æ‹©å™¨
                document.getElementById('monthSelect').value = this.currentDate.getMonth();
            }

            generateCalendar() {
                const grid = document.getElementById('calendarGrid');
                grid.innerHTML = '';

                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();
                
                // è·å–å½“æœˆç¬¬ä¸€å¤©å’Œæœ€åä¸€å¤©
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                
                // è·å–ç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå‡ ï¼ˆ0=å‘¨æ—¥ï¼‰
                const startDay = firstDay.getDay();
                // è·å–å½“æœˆæœ‰å¤šå°‘å¤©
                const daysInMonth = lastDay.getDate();

                // ç”Ÿæˆç©ºç™½æ ¼å­ï¼ˆä¸Šä¸ªæœˆçš„æ—¥æœŸï¼‰
                for (let i = 0; i < startDay; i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'day-cell empty';
                    grid.appendChild(emptyDay);
                }

                // ç”Ÿæˆå½“æœˆæ—¥æœŸ
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayCell = document.createElement('div');
                    dayCell.className = 'day-cell';
                    
                    const solarDate = document.createElement('div');
                    solarDate.className = 'solar-date';
                    solarDate.textContent = day;
                    
                    // å†œå†æ—¥æœŸ
                    const lunarDate = document.createElement('div');
                    lunarDate.className = 'lunar-date';
                    const lunar = Lunar.fromDate(new Date(year, month, day));
                    lunarDate.textContent = this.formatLunarDay(lunar.getDay());
                    
                    dayCell.appendChild(solarDate);
                    dayCell.appendChild(lunarDate);

                    // åˆ¤æ–­æ˜¯å¦ä¸ºä»Šå¤©
                    if (this.isToday(year, month, day)) {
                        dayCell.classList.add('today');
                    }

                    // åˆ¤æ–­æ˜¯å¦ä¸ºå‘¨æœ«
                    const currentDayOfWeek = new Date(year, month, day).getDay();
                    if (currentDayOfWeek === 0 || currentDayOfWeek === 6) {
                        dayCell.classList.add('weekend');
                    }

                    // èŠ‚å‡æ—¥åˆ¤æ–­
                    const holiday = this.getHoliday(month + 1, day);
                    if (holiday) {
                        dayCell.classList.add('holiday');
                        const holidayTag = document.createElement('div');
                        holidayTag.className = 'holiday-tag';
                        holidayTag.textContent = holiday;
                        dayCell.appendChild(holidayTag);
                    }

                    grid.appendChild(dayCell);
                }

                // å¡«å……å‰©ä½™æ ¼å­
                const totalCells = grid.children.length;
                const remainingCells = 42 - totalCells;
                for (let i = 0; i < remainingCells; i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'day-cell empty';
                    grid.appendChild(emptyDay);
                }
            }

            formatLunarDay(day) {
                const lunarDays = ['åˆä¸€', 'åˆäºŒ', 'åˆä¸‰', 'åˆå››', 'åˆäº”', 'åˆå…­', 'åˆä¸ƒ', 'åˆå…«', 'åˆä¹', 'åˆå',
                                  'åä¸€', 'åäºŒ', 'åä¸‰', 'åå››', 'åäº”', 'åå…­', 'åä¸ƒ', 'åå…«', 'åä¹', 'äºŒå',
                                  'å»¿ä¸€', 'å»¿äºŒ', 'å»¿ä¸‰', 'å»¿å››', 'å»¿äº”', 'å»¿å…­', 'å»¿ä¸ƒ', 'å»¿å…«', 'å»¿ä¹', 'ä¸‰å'];
                return lunarDays[day - 1] || '';
            }

            isToday(year, month, day) {
                return year === this.today.getFullYear() &&
                       month === this.today.getMonth() &&
                       day === this.today.getDate();
            }

            getHoliday(month, day) {
                const holidays = {
                    '1-1': 'å…ƒæ—¦', '2-14': 'æƒ…äººèŠ‚', '3-8': 'å¦‡å¥³èŠ‚', '4-1': 'æ„šäººèŠ‚',
                    '5-1': 'åŠ³åŠ¨èŠ‚', '6-1': 'å„¿ç«¥èŠ‚', '7-1': 'å»ºå…šèŠ‚', '8-1': 'å»ºå†›èŠ‚',
                    '9-10': 'æ•™å¸ˆèŠ‚', '10-1': 'å›½åº†èŠ‚', '12-25': 'åœ£è¯èŠ‚'
                };
                return holidays[`${month}-${day}`];
            }

            updateTodayInfo() {
                const todayInfo = document.getElementById('todayInfo');
                const lunar = Lunar.fromDate(this.today);
                
                const weekDays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
                const weekDay = weekDays[this.today.getDay()];
                
                todayInfo.innerHTML = `
                    <strong>ä»Šå¤©ï¼š</strong>
                    ${this.today.getFullYear()}å¹´${this.today.getMonth() + 1}æœˆ${this.today.getDate()}æ—¥ 
                    æ˜ŸæœŸ${weekDay} 
                    | å†œå†${lunar.getMonthInChinese()}æœˆ${this.formatLunarDay(lunar.getDay())}
                `;
            }
        }

        // åˆå§‹åŒ–æ—¥å†
        document.addEventListener('DOMContentLoaded', () => {
            new Calendar();
        });
    </script>
</body>
</html>